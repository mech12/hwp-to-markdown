# HWP to Markdown - 최종 결과

## 구현 완료 상태

모든 구현이 완료되었습니다.

| 항목 | 상태 |
|------|------|
| Python API | ✅ 완료 |
| CLI 도구 | ✅ 완료 |
| 웹 API (FastAPI) | ✅ 완료 |
| 이미지 추출 | ✅ 완료 |
| 테스트 | ✅ 15/15 통과 |

## 테스트 결과

```
============================= test session starts ==============================
platform darwin -- Python 3.12.11, pytest-9.0.2

tests/test_api.py::TestAPIEndpoints::test_root PASSED
tests/test_api.py::TestAPIEndpoints::test_health PASSED
tests/test_api.py::TestAPIEndpoints::test_convert_invalid_file PASSED
tests/test_api.py::TestAPIEndpoints::test_convert_sample PASSED
tests/test_api.py::TestAPIEndpoints::test_convert_file_download PASSED
tests/test_api.py::TestAPIEndpoints::test_convert_zip PASSED
tests/test_converter.py::TestHtmlToMarkdown::test_basic_conversion PASSED
tests/test_converter.py::TestHtmlToMarkdown::test_table_conversion PASSED
tests/test_converter.py::TestHtmlToMarkdown::test_list_conversion PASSED
tests/test_converter.py::TestHtmlToMarkdown::test_image_path_replacement PASSED
tests/test_converter.py::TestHtmlToMarkdown::test_strip_script_style PASSED
tests/test_converter.py::TestConvert::test_file_not_found PASSED
tests/test_converter.py::TestConvert::test_sample_conversion PASSED
tests/test_converter.py::TestConvert::test_image_extraction PASSED
tests/test_converter.py::TestCLI::test_import_cli PASSED

======================== 15 passed ========================
```

## 사용 방법

### 설치

```bash
uv add hwp-to-markdown
```

또는:

```bash
pip install hwp-to-markdown
```

### Python API

```python
from hwp_to_markdown import convert

# 파일 경로로 변환
markdown = convert("document.hwp")
print(markdown)

# 파일로 저장 (이미지는 같은 디렉토리의 images/ 폴더에 추출)
convert("document.hwp", output="document.md")

# 이미지 저장 위치 지정
convert("document.hwp", output="document.md", images_dir="./assets")
```

### CLI

```bash
# 기본 사용 (stdout 출력)
hwp2md document.hwp

# 출력 파일 지정
hwp2md document.hwp -o document.md

# 여러 파일 일괄 변환
hwp2md *.hwp --output-dir ./markdown/

# 이미지 디렉토리 지정
hwp2md document.hwp -o document.md --images-dir ./assets

# 조용한 모드
hwp2md document.hwp -o document.md -q
```

### 웹 API (FastAPI)

```bash
# API 의존성 설치
uv sync --extra api

# 서버 실행
uvicorn hwp_to_markdown.api:app --host 0.0.0.0 --port 8000
```

API 엔드포인트:

- `GET /` - API 상태 확인
- `GET /health` - 헬스 체크
- `POST /convert` - HWP → Markdown (JSON 응답)
- `POST /convert/file` - HWP → Markdown 파일 다운로드
- `POST /convert/zip` - HWP → Markdown + 이미지 ZIP 다운로드

API 문서: `http://localhost:8000/docs` (Swagger UI)

## 프로젝트 구조

```
hwp-to-markdown/
├── pyproject.toml          # 패키지 설정 (uv)
├── LICENSE                  # MIT 라이선스
├── README.md               # 프로젝트 설명
├── src/
│   └── hwp_to_markdown/
│       ├── __init__.py     # convert, HwpConversionError export
│       ├── converter.py    # 핵심 변환 로직
│       ├── cli.py          # hwp2md CLI
│       └── api.py          # FastAPI 웹 API
├── tests/
│   ├── __init__.py
│   ├── test_converter.py
│   └── test_api.py
└── docs/
    ├── 구현계획.md
    ├── 중간결과.md
    ├── 최종결과.md
    └── sample-data/
```

## 변환 파이프라인

```
HWP 파일
    ↓
hwp5html (pyhwp CLI)
    ↓
HTML + 이미지 (임시 디렉토리)
    ↓
BeautifulSoup (script/style 제거)
    ↓
markdownify (HTML → Markdown)
    ↓
후처리 (빈 줄 정리)
    ↓
Markdown 파일 + images/ 폴더
```

## 알려진 제한사항

- HWP 5.0 이상 형식만 지원 (pyhwp 제약)
- 복잡한 레이아웃은 일부 손실될 수 있음
- 수식(Equation)은 이미지로 처리됨
- HWPX (Office Open XML 기반) 형식은 미지원

## 개발 명령어

```bash
# 의존성 설치
uv sync --extra dev

# 테스트 실행
uv run pytest -v

# 커버리지 포함 테스트
uv run pytest --cov=hwp_to_markdown
```
